<mat-horizontal-stepper labelPosition="bottom" #stepper
  style="margin-top: 20px;margin-left: 20px;margin-right: 20px; min-height: 650px;">

  <mat-step [stepControl]="firstFormGroup" *ngIf="firstFormGroup">
    <form [formGroup]="firstFormGroup">
      <ng-template matStepLabel>Početak pregleda</ng-template>
      <mat-form-field style="margin-top: 5px;margin-left: 420px; width: 300px;">
        <input matInput placeholder="Pronađite pacijenta (E-mail adresa)" #searchInput>
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
      <button mat-stroked-button color="primary" style="margin-left:8px" (click)="findPatientAppointments()">Pronađi</button>
 
      <h4 *ngIf="patientFlag" style="margin-top: 5px;margin-left: 460px;">Selektujete jedan od pacijentovih termina:</h4>
      <mat-selection-list *ngIf="patientFlag" (ngModelChange)="onChangeAppointment($event)" formControlName="firstCtrl" required class="patient-appointments" [multiple]="false" style="height: 100px"> 
          <mat-list-option [value]="appointment" *ngFor="let appointment of patientAppointments">
          {{ displayAppointmentRow(appointment) }}
          </mat-list-option>
      </mat-selection-list><br>

       <!-- <div class="example-action-buttons">
          <button mat-button (click)="accordion.openAll()">Expand All</button>
          <button mat-button (click)="accordion.closeAll()">Collapse All</button>
        </div>   -->
      <mat-accordion class="example-headers-align" multi>
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Pacijent se pojavio na pregledu
            </mat-panel-title>
            <mat-panel-description>
              Potvrdite početak pregleda
              <mat-icon>slideshow</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>

          <div>
            <button mat-raised-button color="primary" matStepperNext (click)="firstNextButtonClicked()" style="float: left;margin-top: 10px;">Započni</button>
          </div>

        </mat-expansion-panel>

        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Pacijent se nije pojavio na pregledu
            </mat-panel-title>
            <mat-panel-description>
              Završite pregled zbog nedolaženja pacijenta
              <mat-icon>highlight_off</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>

          <div>
            <button mat-raised-button color="warn" (click)="patientNotHeldOnAppointment()" style="float: left;margin-top: 10px;">Završi</button>
          </div>

        </mat-expansion-panel>
      </mat-accordion>
    </form>
  </mat-step>

  <mat-step [stepControl]="secondFormGroup">
    <form [formGroup]="secondFormGroup">
      <ng-template matStepLabel>Unos informacija o pregledu</ng-template>

      <mat-form-field class="example-full-width">
        <mat-label>Unos informacija o pregledu</mat-label>
        <textarea matInput placeholder=""></textarea>
      </mat-form-field>

      <div>
        <button mat-raised-button color="warn" matStepperPrevious style="float: left;">Nazad</button>
        <button mat-raised-button color="primary" matStepperNext style="float: right;">Dalje</button>
      </div>

    </form>
  </mat-step>

  <mat-step [stepControl]="thirdFormGroup">
    <form [formGroup]="thirdFormGroup">
      <ng-template matStepLabel>Prepisivanje lekova</ng-template>
      
      <div class="table-container">
      <table mat-table [dataSource]="dataSource" class="mat-elevation-z8" class="medicinesTable">

        <!-- Checkbox Column -->
        <ng-container matColumnDef="select">
          <th mat-header-cell *matHeaderCellDef>
            <mat-checkbox (change)="$event ? masterToggle() : null"
                          [checked]="selection.hasValue() && isAllSelected()"
                          [indeterminate]="selection.hasValue() && !isAllSelected()"
                          [aria-label]="checkboxLabel()">
            </mat-checkbox>
          </th>
          <td mat-cell *matCellDef="let row">
            <mat-checkbox (click)="$event.stopPropagation()"
                          (change)="$event ? selection.toggle(row) : null"
                          [checked]="selection.isSelected(row)"
                          [aria-label]="checkboxLabel(row)">
            </mat-checkbox>
          </td>
        </ng-container>

        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef> Naziv leka </th>
          <td mat-cell *matCellDef="let element"> {{element.name}}  </td>
        </ng-container>

        <!-- Manufacturer Column -->
        <ng-container matColumnDef="manufacturer">
          <th mat-header-cell *matHeaderCellDef> Proizvođač </th>
          <td mat-cell *matCellDef="let element"> {{element.name}}  </td>
        </ng-container>

        <!-- Type Column -->
        <ng-container matColumnDef="type">
          <th mat-header-cell *matHeaderCellDef> Vrsta leka </th>
          <td mat-cell *matCellDef="let element"> {{element.name}}  </td>
        </ng-container>
      
        <!-- Specification Column -->
        <ng-container matColumnDef="specification">
          <th mat-header-cell *matHeaderCellDef> Specifikacija leka </th>
          <td mat-cell *matCellDef="let element"><button mat-stroked-button color="primary" (click)="openDialog()" class="modal-dialog">Prikaži</button> </td>
        </ng-container>

        <!-- Prescribe Column -->
        <ng-container matColumnDef="prescribe">
          <th mat-header-cell *matHeaderCellDef> Prepišite lek </th>
          <td mat-cell *matCellDef="let element"><button mat-raised-button color="primary" (click)="openDialog()" class="modal-dialog">Prepiši lek</button> </td>
        </ng-container>

        <!-- <ng-container matColumnDef="substitute">
          <th mat-header-cell *matHeaderCellDef> Zamenski lekovi </th>
          <td mat-cell *matCellDef="let element">
            <mat-form-field style="max-width:140px;">
              <mat-label>Zamenski lekovi</mat-label>
              <mat-select [formControl]="medicines" multiple>
                <mat-select-trigger>
                {{medicines.value ? medicines.value[0].name : ''}}
                <span *ngIf="medicines.value?.length > 1" class="example-additional-selection">
                  (+ još {{medicines.value.length - 1}}) 
                </span>
                </mat-select-trigger>
                <mat-option *ngFor="let medicine of medicineList" [value]="medicine">{{medicine}}</mat-option>
              </mat-select>
              </mat-form-field> 
          </td>
        </ng-container> -->
   
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"
            (click)="selection.toggle(row)">
        </tr>
      </table>
      </div>

      <div>
        <button mat-raised-button color="warn" matStepperPrevious style="float: left;margin-top: 40px;">Nazad</button>
        <button mat-raised-button color="primary" matStepperNext style="float: right;;margin-top: 40px;">Dalje</button>
      </div>

    </form>
  </mat-step>

  <mat-step [stepControl]="fourthFormGroup">
    <form [formGroup]="fourthFormGroup">
      <ng-template matStepLabel>Zakazivanje novog pregleda</ng-template>

      <mat-tab-group mat-align-tabs="start" style="width: 420px;margin-left: 380px;">
        <mat-tab label="Unapred definisani termini">
          <h4 style="padding-top: 10px;margin-left: 60px;">Selektujete jedan od ponuđenih termina:</h4>
            <mat-selection-list  class="examination-terms" [multiple]="false"required> 
                <mat-list-option>
                20.02.2021. 10:00 - 10:30
                </mat-list-option>
            </mat-selection-list>
        </mat-tab>

        <mat-tab label="Definisanje novog termina">
          <h4 style="padding-top: 10px;margin-left: 120px;">Izaberite datum pregleda:</h4>
            <mat-form-field appearance="fill" style="margin-left: 85px">
                <mat-label>Datum pregleda</mat-label>
                <input matInput [matDatepicker]="picker" required>
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker color="primary"></mat-datepicker>
            </mat-form-field>

            <h4 style="margin-left: 95px;">Izaberite početno i krajnje vreme:</h4>
            <div style="margin-left: 122px;float: left;">
              <ngx-mat-timepicker [stepHour]="1" [stepMinute]="5" ></ngx-mat-timepicker>
            </div>
            <div style="margin-left: 230px;">
              <ngx-mat-timepicker [stepHour]="1" [stepMinute]="5" ></ngx-mat-timepicker>
            </div>
   
        </mat-tab>
      </mat-tab-group>
      
      <div>
        <button mat-raised-button color="warn" matStepperPrevious style="float: left;margin-top: 40px;">Nazad</button>
        <button mat-raised-button color="primary" matStepperNext style="float: right;;margin-top: 40px;">Dalje</button>
      </div>
    </form>
  </mat-step>

  <mat-step>
    <ng-template matStepLabel>Kraj pregleda</ng-template>

    <br><h1 class="mat-h1" style="margin-top: 50px; margin-left: 350px;">Uspešno ste izvršili pregled za pacijenta</h1><br><br>
    <h1 class="mat-h1" style="margin-left: 442px;">Potvrdite kraj pregleda</h1><br><br>

    <div>
      <button mat-flat-button color="primary" matStepperNext style="margin-left: 522px;">Potvrdi</button>
    </div>
  </mat-step>

</mat-horizontal-stepper>
